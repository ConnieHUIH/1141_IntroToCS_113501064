<!DOCTYPE html>
<html>
<head>
    <title>113501064_HW6_1A2B</title>
	<style>
		#Input, button {
		    display: inline-block;
		    margin-bottom: 3px;
		}
		button {
			border-radius: 5px;
			border: 0.5px;
			margin-top: 2px;
			height: 20px;
			background-color: #7c856d;
			color: #b4bfa1;
		}
		button:hover {
			color: #454a3c;
		}
	    #recordbox {
	    	text-align: center;
	        margin-top: 20px;
	        padding: 10px;
	        border: 3px solid #454a3c;
	        background: #d6e3cf;
	        width: 500px;
	        min-height: 100px; 
	        border-radius: 15px;
	    }
	    #interface {
	    	display: flex;
	    	flex-direction: column;
	    	justify-content: center;
	    	align-items: center;
	 	}
	</style>
</head>
<body style = "background-color: #b4bfa1;">
	<h1 style = "text-align: center;">113501064_HW6_1A2B</h1>

	<div id = "interface">
		<br>Enter 4 unique numbers
		<input type="text" id = "Input">
		<button onclick="play()">Guess!</button>
		<div id="recordbox"><strong>Guess Record: </strong><br></div>
	</div>

	<script>
		//Generates the answer for the game.設定取4個不同數字
    	function generateAnswer(){
 			let numbers = ["0","1","2","3","4","5","6","7","8","9"];
   			let gameanswer = [];

			for (let i = 0; i < 4; i++){
				let digit = Math.floor(Math.random() * numbers.length);
				gameanswer.push(numbers[digit]); // 把digit的數字連在一起
        		numbers.splice(digit, 1); // 移除Array中digit開始的1個元素(數字)
			}
			return gameanswer;
    	}

    	// Validates the player’s input. 1. 需要是四位數 2. 沒有數字重複
    	function isValid(str){
		    if (str.length !== 4) {
		    	return false;
		    }
		    for (let i = 0; i < str.length; i++) {
		    	for (let s = i + 1; s< str.length; s++){
		    			if (str[i] === str[s]){
		    				return false;
		    			}
		    	}
		    }
		    return true;		    
    	}

		// Calculate A and B
		function checkAB(guess, ans) {
		    let A = 0;
		    let B = 0;

		    for (let i = 0; i < 4; i++) {
		        if (guess[i] === ans[i]) {
		            A++;
		        } else if (ans.includes(guess[i])) {
		            B++;
		        }
		    }
		    return `${A}A${B}B`;
		}
		////////////上面是運算///////下面是遊戲/////////////////////////////
		// Game flow
		let answers = generateAnswer();
		let attempts = 0;

		function play() {
		    let inputField = document.getElementById("Input");
		    let guess = inputField.value.trim();

		    // whether it is valid
		    if (!isValid(guess)) {
		        alert("Invalid input! Please enter 4 unique digits.");
		        inputField.value = "";
		        return;
		    }

		    let guessArray = guess.split(""); //轉成陣列Array

		    // update the guess count
		    attempts++;

		    // calculate the A/B result
		    let result = checkAB(guessArray, answers);


		    // displays the attempt in the record area 想要答對時加粗
			if (result === "4A0B") {
			    document.getElementById("recordbox").innerHTML +=
			        `<b>第 ${attempts} 次： ${guess} → ${result}</b><br>`;
			} else {
			    document.getElementById("recordbox").innerHTML +=
			        `第 ${attempts} 次： ${guess} → ${result}<br>`;
			}


		    // Correct
		    if (result === "4A0B") {
		    	let answerString = "";
		    	for (let i = 0; i < answers.length; i++){
		    		answerString += answers[i];
		    	}
		        alert(`恭喜答對! 你花了 ${attempts} 次!\n正確答案就是: ${answerString}`);
		    }

		    inputField.value = "";


		}

	</script>
</body>
</html>